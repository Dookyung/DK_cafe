<!DOCTYPE html>
<html lang="en">

<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description" content="">
  <meta name="generator" content="Hugo 0.35" />

  <title>R Package 만들기 4 &middot; Big Data Analytics with R</title>

  
  
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pure/1.0.0/pure-min.css">

  <!--[if lte IE 8]>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pure/1.0.0/grids-responsive-old-ie-min.css">
  <![endif]-->
  <!--[if gt IE 8]><!-->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pure/1.0.0/grids-responsive-min.css">
  <!--<![endif]-->

  <!--[if lte IE 8]>
  <link rel="stylesheet" href="../../css/side-menu-old-ie.css">
  <![endif]-->
  <!--[if gt IE 8]><!-->
  <link rel="stylesheet" href="../../css/side-menu.css">
  <!--<![endif]-->

  <link rel="stylesheet" href="../../css/blackburn.css">
  <link rel="stylesheet" href="../../css/schedule.css">
  <link rel="stylesheet" href="../../css/menu.css">

  
  <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.0.10/css/all.css">

  
  <link href="https://fonts.googleapis.com/css?family=Raleway" rel="stylesheet" type="text/css">

  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

 
  

  
  <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/androidstudio.min.css">
  <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
  
  <script>hljs.initHighlightingOnLoad();</script>
  

  <link rel="shortcut icon" href="../../img/favicon.ico" type="image/x-icon" />

  
  

</head>


<body>
<div id="layout">

  
<a href="#menu" id="menuLink" class="menu-link">
  
  <span></span>
</a>
<div id="menu">

  
  <a class="pure-menu-heading brand" href="../../">DK Cafe</a>


  <div class="pure-menu">
    <ul class="pure-menu-list">
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="../../"><i class='fa fa-home fa-fw'></i>Blog</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="../../schedule/"><i class='fa fa-calendar-check'></i>Schedule</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="../../syllabus/"><i class='fa fa-calendar-check'></i>R4DS Course</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="../../post/"><i class='fa fa-list fa-fw'></i>Posts</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://dkkim.netlify.com/"><i class='fa fa-user fa-fw'></i>About</a>
      
        </li>
      
    </ul>
  </div>

  <div class="pure-menu social">
  <ul class="pure-menu-list">

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

  </ul>
</div>


  <div>
  <div class="small-print">
    <small></small>
  </div>
  <div class="small-print">
    <small>Built with&nbsp;<a href="https://gohugo.io/" target="_blank">Hugo</a></small>
    <small>Theme&nbsp;<a href="https://github.com/yoshiharuyamashita/blackburn" target="_blank">Blackburn</a></small>
  </div>
</div>

</div>


  <div id="main">


<div class="header">
  <h1>R Package 만들기 4</h1>
  <h2></h2>
</div>
<div class="content">

  <div class="post-meta">

  <div>
    <i class="fa fa-calendar fa-fw"></i>
    <time>Jun 07</time>
  </div>

  

  

  
  
  
  <div>
    <i class="fa fa-tags fa-fw"></i>
    
      <a class="post-taxonomy-tag" href="../../tags/devtools">devtools</a>
    
  </div>
  
  

</div>

  <div id="---with-roxygen2" class="section level1">
<h1>나만의 함수 추가하기 with roxygen2</h1>
<pre class="r"><code>library(devtools)
library(roxygen2)</code></pre>
<p>아래와 같은 감마분포의 MOME 함수를 패키지에 넣도록 하겠다.</p>
<pre class="r"><code>mom_gamma &lt;- function(sample_g){
    x_bar  &lt;- mean(sample_g)
    x2_bar &lt;- mean(sample_g^2)
    
    mom_theta &lt;- (x2_bar - x_bar^2) / x_bar
    mom_k &lt;- x_bar / mom_theta
    
    list(k_hat = mom_k, theta_hat = mom_theta)
}</code></pre>
<p>위의 코드를 패키지의 R폴더에 inference.R 파일을 만들고 붙여넣고 저장하자. 또한, 이제는 필요가 없는 R폴더의 hello.R 파일과 mam폴더의 hello.Rd 파일은 삭제하도록 한다.</p>
<p>그 다음 Build 탭의 Check 버튼을 눌러보면, 다음과 같은 경고 메세지가 뜨는 것을 알 수 있다.</p>
<p>이 경고 메세지는 우리가 방금 패키지에 넣은 mom_gamma() 함수에 대한 문서가 없다는 내용이다. man 폴더에 .Rd 파일이 이러한 역할을 한다고 배웠다.</p>
<div id="roxygen2-----" class="section level2">
<h2>roxygen2 패키지를 이용한 설명서 관리 자동화</h2>
<p>이러한 경고 메세지를 안 받기 위해서는 각 함수별로 .Rd 파일을 작성해야 한다. roxygen2 패키지는 이러한 함수 설명서 파일 작성을 R코드 안의 #’태그를 이용하여 자동화 시켜준다.</p>
<p>roxygen2를 이용할 경우 두 가지 큰 장점이 있는데,</p>
<ol style="list-style-type: decimal">
<li>함수별 설명서 파일(.Rd)를 만들어줄 필요가 없어진다.</li>
<li>NAMESPACE 파일을 손 댈 필요가 없어진다.</li>
</ol>
<p>inference.R 파일 안에 정의된 함수의 위쪽에 roxygen 코멘트를 붙여주자.</p>
<pre><code>#&#39; Method of Moments Estimator for gamma dist.
#&#39;
#&#39; mom_gamma function will calculate mom estimate for the shape parameter &quot;k&quot; and the scale parameter &quot;theta&quot; by using given sample.
#&#39;
#&#39; @param sample_g the given sample to calculate the estimate of the parameters.
#&#39; @return A 2 by 1 vector containing estimate of parameters k and theta: c(k, theta)
#&#39; @examples
#&#39;   my_sample &lt;- rgamma(50, shape = 2, scale = 3)
#&#39;   mom_gamma(my_sample)
#&#39; @export
mom_gamma &lt;- function(sample_g){
    x_bar  &lt;- mean(sample_g)
    x2_bar &lt;- mean(sample_g^2)
    
    mom_theta &lt;- (x2_bar - x_bar^2) / x_bar
    mom_k &lt;- x_bar / mom_theta
    
    list(k_hat = mom_k, theta_hat = mom_theta)
}</code></pre>
<ul>
<li><strong>Title</strong> : 설명서 제목</li>
<li><strong>Description</strong> : 제목에서 한줄을 뗀 다음 줄은 설명서에서 함수의 description란에 위치</li>
<li>__<span class="citation">@param__</span> : 함수에 들어가는 입력값(parameter)을 명시해주고, 이에 대한 설명을 써주면 된다.</li>
<li>__<span class="citation">@return__</span> : 함수의 결과값에 대한 설명</li>
<li><p>__<span class="citation">@example__</span> : 함수를 실제로 어떻게 적용하는지에 대한 예</p></li>
<li><p>__<span class="citation">@export__</span> : 이 태그는 설명서가 아닌 NAMESPACE에 대한 태그이다. 이 태그를 붙이게 되면 패키지를 설치한 사용자가 mom_gamma() 함수를 사용할 수 있게 된다. 태그의 의미 그대로 함수를 패키지의 밖으로 내보낼 수 있도록 만들어 준다.</p></li>
</ul>
</div>
<div id="roxygen2--" class="section level2">
<h2>roxygen2 패키지의 적용</h2>
<p>roxygen2을 사용하여 설명서 파일을 작성하려면 devtools::document() 함수를 실행시켜주면 자동으로 roxygen2 패키지를 사용해서 설명서와 그 외의 것들을 처리해준다.</p>
<p>단, roxygen2패키지가 NAMESPACE 파일까지 자동으로 처리하게끔 하기 위해서는 현재 패키지 폴더의 NAMESPACE 파일을 지워줘야 한다. 따라서, 우리가 할 일은 다음과 같다.</p>
<p>패키지 폴더에 있는 NAMESPACE 파일을 삭제한다. 콘솔창에 devtools::document() 명령어를 입력한다.</p>
<p>이것으로 인해 바뀌는 점은 3가지 이다.</p>
<ol style="list-style-type: decimal">
<li>man 폴더에 mom_gamma.Rd 파일이 생성</li>
<li>DESCRIPTION 파일의 내용에 RoxygenNote: 항목이 추가</li>
<li>NAMESPACE 파일의 내용에 아래와 같은 내용이 추가 된다.</li>
</ol>
<pre><code># Generated by roxygen2: do not edit by hand
export(mom_gamma)</code></pre>
</div>
<div id="-" class="section level2">
<h2>패키지 확인</h2>
<p>Rstudio의 빌드(Build)탭에서 제공하는 check 버튼을 누르면 이전에 보였던 경고 메세지가 더 이상 나오지 않는 것을 알 수 있다.</p>
<p>변경된 사항을 Git &gt; Commit을 누른 후, 변경 사항을 간략히 입력하고 Commit 버튼과 Push를 차례로 눌러 Github에 변동사항을 반영하도록 하자.</p>
<p>이제 패지키가 잘 작동하는지 확인하기 위하여 다음의 명령어를 사용하여 패키지를 설치 후 함수를 사용해보자.</p>
<pre class="r"><code>devtools::install_github(&quot;Dookyung/R4me&quot;)
library(r4issactoast)
my_sample &lt;- rgamma(100, shape = 2, scale = 4)
mom_gamma(my_sample)


##     k_hat theta_hat 
##  1.943065  3.984109</code></pre>
</div>
<div id="-" class="section level2">
<h2>참고 문헌</h2>
<p>[1] Wickham, Hadley. R packages: organize, test, document, and share your code. &quot; O’Reilly Media, Inc.“, 2015.</p>
<p>[2] Jennifer (Jenny) Bryan, Write your own R package STAT 545</p>
<p>[3] 오픈소스SW라이선스 종합정보시스템 (<a href="https://olis.or.kr/license/introduction.do" class="uri">https://olis.or.kr/license/introduction.do</a>)</p>
<p>[4] Writing R extension (<a href="https://cran.r-project.org/doc/manuals/r-release/R-exts.html#The-DESCRIPTION-file" class="uri">https://cran.r-project.org/doc/manuals/r-release/R-exts.html#The-DESCRIPTION-file</a>)</p>
</div>
</div>


  
<div class="prev-next-post pure-g">
  <div class="pure-u-1-24" style="text-align: left;">
    
    <a href="../../post/2018-06-07-r-package5/"><i class="fa fa-chevron-left"></i></a>
    
  </div>
  <div class="pure-u-10-24">
    
    <nav class="prev">
      <a href="../../post/2018-06-07-r-package5/">R Package 만들기 5</a>
    </nav>
    
  </div>
  <div class="pure-u-2-24">
    &nbsp;
  </div>
  <div class="pure-u-10-24">
    
    <nav class="next">
      <a href="../../post/2018-06-06-r-package3/">R Package 만들기 3</a>
    </nav>
    
  </div>
  <div class="pure-u-1-24" style="text-align: right;">
    
    <a href="../../post/2018-06-06-r-package3/"><i class="fa fa-chevron-right"></i></a>
    
  </div>
</div>



  
<div id="disqus_thread"></div>
<script type="text/javascript">

(function() {
    
    
    if (window.location.hostname == "localhost")
        return;

    var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
    var disqus_shortname = 'Your Disqus shortname';
    dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
})();
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com/" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>


</div>

</div>
</div>
<script src="../../js/ui.js"></script>






</body>
</html>

